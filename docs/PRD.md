# SelectEatMenu 需求文档（PRD）

## 1. 背景与问题
用户在日常用餐时常遇到“今天吃什么”的选择困难。希望通过一个离线可用的桌面应用，在可配置的菜单范围内快速给出推荐，并尽量避免近期重复。

## 2. 目标
- 快速完成“随机推荐吃什么”的核心闭环：导入菜单 → 推荐 → 记录 → 下次避开近期重复。
- 离线优先：不依赖网络服务，数据本地持久化。
- 可解释与可控：可查看近期历史，可配置冷却时间，可手动重置。

## 3. 非目标
- 不做账号体系与云端同步。
- 不做外卖平台/地图/支付等第三方集成。
- 不做复杂营养分析与个性化算法（先用规则驱动的去重随机）。

## 4. 用户画像与使用场景
- 个人用户：每天午/晚饭前打开应用，点击一次得到推荐。
- 轻度选择困难：希望一键出结果，并可在结果不满意时快速“再抽一次”。
- 介意重复：希望近期吃过的不要频繁出现。

## 5. 关键概念
- 菜单项（Menu Item）：可被推荐的餐食条目，如“麻辣烫”“兰州拉面”。
- 菜单配置（Menu Config）：菜单项集合，可从本地文件导入。
- 历史记录（History）：被选择/确认吃过的条目及日期时间。
- 冷却期（Cooldown）：最近 N 天内吃过的条目在随机时默认不可选。

## 6. 核心流程
1) 用户导入菜单配置文件（或使用内置示例菜单）。
2) 用户点击“随机推荐”，应用给出一个候选菜单项。
3) 用户点击“就吃这个”，该条目写入历史记录。
4) 下一次随机推荐时，优先从非冷却集合中抽取；若集合为空，提示用户调整冷却或清空历史。

## 7. 功能需求

### 7.1 菜单管理
- 支持从本地选择 JSON 文件导入菜单配置。
- 支持查看当前已加载的菜单项列表（搜索可后置）。
- 支持移除某个菜单项（可后置）。
- 当菜单为空时，随机功能不可用且给出引导。

### 7.2 随机推荐
- 默认基于“可用候选集”随机选取 1 项并展示。
- 支持“换一个”重新随机。
- 当可用候选集为空时：
  - 提示原因（冷却期导致无可选项）
  - 提供操作入口：降低冷却天数 / 清空历史 / 允许从冷却集合抽取（可选开关，可后置）

### 7.3 历史记录与冷却
- 记录“就吃这个”的确认操作：条目 + 时间戳。
- 历史可列表展示（最近优先），支持一键清空。
- 冷却天数可配置（默认 3 天），修改后立即影响随机候选集。

### 7.4 设置与数据持久化
- 菜单配置、历史记录、冷却天数需要在应用重启后保留。
- 本地存储方式：
  - 优先 electron-store（或本地 JSON 文件），不要求用户手动管理存储路径。

### 7.5 安全与权限
- 渲染进程不直接使用 Node/Electron 特权能力。
- 文件选择、读写、持久化通过 preload 暴露受控 API 完成。

## 8. 数据模型（建议）

### 8.1 MenuItem
- id: string（稳定标识，可由名称生成或由导入文件提供）
- name: string
- tags?: string[]
- enabled?: boolean（默认 true）

### 8.2 HistoryEntry
- id: string（uuid）
- menuItemId: string
- menuItemNameSnapshot: string（避免菜单变更后无法回显）
- eatenAt: string（ISO8601）

### 8.3 Settings
- cooldownDays: number
- allowCooldownPick?: boolean

## 9. 约束与边界情况
- 导入文件格式错误：提示错误并保持原有数据不变。
- 菜单项重名：以 id 区分；如无 id 则以 name + hash 生成。
- 冷却天数为 0：表示不启用冷却。
- 历史很长：只影响过滤与展示，需保证随机仍可瞬时完成。

## 10. 验收标准（MVP）
- 可导入菜单 JSON 并成功展示列表。
- 点击随机可得到推荐；点击确认可写入历史。
- 冷却期生效：近期吃过的不会被推荐；当无可选项时有明确提示与可操作入口。
- 重启应用后，菜单/历史/冷却设置仍存在。

## 11. 里程碑（建议）
- M1：UI 原型 + 纯前端状态（不落盘）
- M2：preload + IPC + 本地持久化（菜单/历史/设置）
- M3：完善导入校验、边界提示与体验

